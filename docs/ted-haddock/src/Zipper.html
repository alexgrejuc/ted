<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Zipper
Description : Creation and manipulation of a Text Zipper.

The functions and data types for the creating and manipulating the core data structure
of the editor.
-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns, PatternSynonyms, OverloadedLists, OverloadedStrings #-}</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Zipper</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lib.html"><span class="hs-identifier">Lib</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(|&gt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;&lt;)</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-identifier">Empty</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-operator">(:&lt;|)</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-operator">(:|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">snoc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">uncons</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unsnoc</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cons</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">append</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Manipulate</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.ICU</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">brkBreak</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">breakSentence</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">breaks</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.ICU.Types</span></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">type</span><span> </span><span id="Position"><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-var">Position</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | A 2-d zipper representing the contents of a text file with newlines stripped.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--   A paragraph is represented by the Text to the left of the currently-selected contents, and the</span><span>
</span><span id="line-28"></span><span class="hs-comment">--   Text to its right.</span><span>
</span><span id="line-29"></span><span class="hs-keyword">data</span><span> </span><span id="Zipper"><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-30"></span><span>   </span><span id="Zipper"><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="above"><span class="annot"><span class="annottext">Zipper -&gt; Seq Text
</span><a href="Zipper.html#above"><span class="hs-identifier hs-var hs-var">above</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>   </span><span class="hs-comment">-- ^ The paragraphs of text above the current line</span><span>
</span><span id="line-31"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="left"><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var hs-var">left</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>       </span><span class="hs-comment">-- ^ The text left and above the current selection</span><span>
</span><span id="line-32"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="selection"><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>       </span><span class="hs-comment">-- ^ The current selection</span><span>
</span><span id="line-33"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="right"><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var hs-var">right</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>       </span><span class="hs-comment">-- ^ The text right and below the current selection</span><span>
</span><span id="line-34"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="below"><span class="annot"><span class="annottext">Zipper -&gt; Seq Text
</span><a href="Zipper.html#below"><span class="hs-identifier hs-var hs-var">below</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>   </span><span class="hs-comment">-- ^ The paragraphs of text below the current line</span><span>
</span><span id="line-35"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-36"></span><span>   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070531"><span id="local-6989586621679070533"><span id="local-6989586621679070535"><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; ShowS
[Zipper] -&gt; ShowS
Zipper -&gt; String
(Int -&gt; Zipper -&gt; ShowS)
-&gt; (Zipper -&gt; String) -&gt; ([Zipper] -&gt; ShowS) -&gt; Show Zipper
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Zipper] -&gt; ShowS
$cshowList :: [Zipper] -&gt; ShowS
show :: Zipper -&gt; String
$cshow :: Zipper -&gt; String
showsPrec :: Int -&gt; Zipper -&gt; ShowS
$cshowsPrec :: Int -&gt; Zipper -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070526"><span id="local-6989586621679070528"><span class="annot"><span class="annottext">Zipper -&gt; Zipper -&gt; Bool
(Zipper -&gt; Zipper -&gt; Bool)
-&gt; (Zipper -&gt; Zipper -&gt; Bool) -&gt; Eq Zipper
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Zipper -&gt; Zipper -&gt; Bool
$c/= :: Zipper -&gt; Zipper -&gt; Bool
== :: Zipper -&gt; Zipper -&gt; Bool
$c== :: Zipper -&gt; Zipper -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="annot"><a href="Zipper.html#emptyZipper"><span class="hs-identifier hs-type">emptyZipper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-39"></span><span id="emptyZipper"><span class="annot"><span class="annottext">emptyZipper :: Zipper
</span><a href="Zipper.html#emptyZipper"><span class="hs-identifier hs-var hs-var">emptyZipper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#makeZipper"><span class="hs-identifier hs-var">makeZipper</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | A not-so-smart constructor for a Zipper.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--   If the underlying representation of a Zipper is extended, old</span><span>
</span><span id="line-43"></span><span class="hs-comment">--   examples and test cases might not have to be changed.</span><span>
</span><span id="line-44"></span><span class="annot"><a href="Zipper.html#makeZipper"><span class="hs-identifier hs-type">makeZipper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-45"></span><span id="makeZipper"><span class="annot"><span class="annottext">makeZipper :: Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#makeZipper"><span class="hs-identifier hs-var hs-var">makeZipper</span></a></span></span><span> </span><span id="local-6989586621679070522"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070522"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070521"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070521"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070520"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070520"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070519"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070519"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070518"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070518"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070522"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070521"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070520"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070519"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070518"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | Makes a Zipper with no lines above or below.</span><span>
</span><span id="line-48"></span><span class="annot"><a href="Zipper.html#paragraph"><span class="hs-identifier hs-type">paragraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-49"></span><span id="paragraph"><span class="annot"><span class="annottext">paragraph :: Text -&gt; Text -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#paragraph"><span class="hs-identifier hs-var hs-var">paragraph</span></a></span></span><span> </span><span id="local-6989586621679070516"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070516"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070515"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070515"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070514"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070514"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#makeZipper"><span class="hs-identifier hs-var">makeZipper</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070516"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070515"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070514"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Makes the (left, selection, right) portion of a Zipper at the specified column from a line of</span><span>
</span><span id="line-52"></span><span class="hs-comment">--   text.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">--   &gt;&gt;&gt; fromLine 0 &quot;123456789&quot; == paragraph &quot;&quot; &quot;1&quot; &quot;23456789&quot;</span><span>
</span><span id="line-55"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Zipper.html#fromLine"><span class="hs-identifier hs-type">fromLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-58"></span><span id="fromLine"><span class="annot"><span class="annottext">fromLine :: Int -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#fromLine"><span class="hs-identifier hs-var hs-var">fromLine</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="Zipper.html#emptyZipper"><span class="hs-identifier hs-var">emptyZipper</span></a></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Zipper.html#fromLine"><span class="hs-identifier hs-var">fromLine</span></a></span><span> </span><span id="local-6989586621679070512"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679070512"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679070511"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679070511"><span class="hs-identifier hs-var">t</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#paragraph"><span class="hs-identifier hs-var">paragraph</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070510"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070509"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-60"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070510"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070510"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679070509"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070509"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070512"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070511"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Split a Seq Text into (above, selection, below) at the specified row (0-indexed).</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Zipper.html#splitThree"><span class="hs-identifier hs-type">splitThree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span id="splitThree"><span class="annot"><span class="annottext">splitThree :: Int -&gt; Seq Text -&gt; (Seq Text, Text, Seq Text)
</span><a href="Zipper.html#splitThree"><span class="hs-identifier hs-var hs-var">splitThree</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Empty</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="annot"><a href="Zipper.html#splitThree"><span class="hs-identifier hs-var">splitThree</span></a></span><span> </span><span id="local-6989586621679070505"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070505"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679070504"><span class="annot"><span class="annottext">l :: Seq Text
</span><a href="#local-6989586621679070504"><span class="hs-identifier hs-var">l</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; (Seq Text, Seq Text)
forall a. Int -&gt; Seq a -&gt; (Seq a, Seq a)
</span><span class="hs-identifier hs-var">S.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070505"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070504"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-67"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679070502"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070502"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span id="local-6989586621679070501"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070501"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070500"><span class="annot"><span class="annottext">r :: Seq Text
</span><a href="#local-6989586621679070500"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070502"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070501"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070500"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>                        </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621679070499"><span class="annot"><span class="annottext">x :: Item (Seq Text)
</span><a href="#local-6989586621679070499"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070498"><span class="annot"><span class="annottext">r :: Seq Text
</span><a href="#local-6989586621679070498"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Item (Seq Text)
Text
</span><a href="#local-6989586621679070499"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070498"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Empty</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070497"><span class="annot"><span class="annottext">r :: Seq Text
</span><a href="#local-6989586621679070497"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070497"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- n == 0, not an actual use case</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Makes a Zipper from Text by splitting on newlines.</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">--   &gt;&gt;&gt; fromText (0,0) &quot;1\n2\n3\n&quot; == makeZipper [] &quot;&quot; &quot;1&quot; &quot;&quot; [&quot;2&quot;,&quot;3&quot;]</span><span>
</span><span id="line-74"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Zipper.html#fromText"><span class="hs-identifier hs-type">fromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-77"></span><span id="fromText"><span class="annot"><span class="annottext">fromText :: Position -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#fromText"><span class="hs-identifier hs-var hs-var">fromText</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;&quot;</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="Zipper.html#emptyZipper"><span class="hs-identifier hs-var">emptyZipper</span></a></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Zipper.html#fromText"><span class="hs-identifier hs-var">fromText</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070495"><span class="annot"><span class="annottext">c :: Int
</span><a href="#local-6989586621679070495"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679070494"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679070494"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679070493"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679070493"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#fromLine"><span class="hs-identifier hs-var">fromLine</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070495"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070492"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">above :: Seq Text
</span><a href="Zipper.html#above"><span class="hs-identifier hs-var">above</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070491"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">below :: Seq Text
</span><a href="Zipper.html#below"><span class="hs-identifier hs-var">below</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070490"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-79"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>      </span><span id="local-6989586621679070489"><span class="annot"><span class="annottext">ls :: Seq Text
</span><a href="#local-6989586621679070489"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Seq Text
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Seq Text) -&gt; [Text] -&gt; Seq Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.lines</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070493"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070491"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070491"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679070492"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070492"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679070490"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070490"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; (Seq Text, Text, Seq Text)
</span><a href="Zipper.html#splitThree"><span class="hs-identifier hs-var">splitThree</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070495"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070489"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Zipper.html#combineLine"><span class="hs-identifier hs-type">combineLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-84"></span><span id="combineLine"><span class="annot"><span class="annottext">combineLine :: Zipper -&gt; Text
</span><a href="Zipper.html#combineLine"><span class="hs-identifier hs-var hs-var">combineLine</span></a></span></span><span> </span><span id="local-6989586621679070485"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070485"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070485"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070485"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070485"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Zipper.html#toLines"><span class="hs-identifier hs-type">toLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-87"></span><span id="toLines"><span class="annot"><span class="annottext">toLines :: Zipper -&gt; Seq Text
</span><a href="Zipper.html#toLines"><span class="hs-identifier hs-var hs-var">toLines</span></a></span></span><span> </span><span id="local-6989586621679070483"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070483"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Seq Text
</span><a href="Zipper.html#above"><span class="hs-identifier hs-var hs-var">above</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070483"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq Text -&gt; Seq Text
forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#combineLine"><span class="hs-identifier hs-var">combineLine</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070483"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Seq Text -&gt; Seq Text
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Seq Text
</span><a href="Zipper.html#below"><span class="hs-identifier hs-var hs-var">below</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070483"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Converts a Zipper into Text by interspersing newlines between all lines.</span><span>
</span><span id="line-90"></span><span class="hs-comment">--	  Obivated in editor by toText3 and only used for testing.</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">--   &gt;&gt;&gt; let text = &quot;1\n2\n3\n4\n&quot; in let z = fromText (1,1) text in text == toText z</span><span>
</span><span id="line-93"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-94"></span><span class="annot"><a href="Zipper.html#toText"><span class="hs-identifier hs-type">toText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-95"></span><span id="toText"><span class="annot"><span class="annottext">toText :: Zipper -&gt; Text
</span><a href="Zipper.html#toText"><span class="hs-identifier hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Zipper.html#toText"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span id="local-6989586621679070481"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070481"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Seq Text -&gt; Text
forall a (t :: * -&gt; *). (Monoid a, Foldable t) =&gt; a -&gt; t a -&gt; a
</span><a href="Lib.html#concatWith"><span class="hs-identifier hs-var">concatWith</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Seq Text -&gt; Text) -&gt; Seq Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Seq Text
</span><a href="Zipper.html#toLines"><span class="hs-identifier hs-var">toLines</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070481"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><a href="Zipper.html#parLen"><span class="hs-identifier hs-type">parLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-99"></span><span id="parLen"><span class="annot"><span class="annottext">parLen :: Zipper -&gt; Int
</span><a href="Zipper.html#parLen"><span class="hs-identifier hs-var hs-var">parLen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679070478"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070478"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070477"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070477"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070476"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070476"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070478"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070477"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070476"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="annot"><a href="Zipper.html#parLines"><span class="hs-identifier hs-type">parLines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-102"></span><span id="parLines"><span class="annot"><span class="annottext">parLines :: Int -&gt; Zipper -&gt; Int
</span><a href="Zipper.html#parLines"><span class="hs-identifier hs-var hs-var">parLines</span></a></span></span><span> </span><span id="local-6989586621679070473"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070473"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070472"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070472"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="Lib.html#roundUp"><span class="hs-identifier hs-var">roundUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Int
</span><a href="Zipper.html#parLen"><span class="hs-identifier hs-var">parLen</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070472"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070473"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070473"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | Converts the visible portion of a Zipper into the text before the selection, the selection,</span><span>
</span><span id="line-105"></span><span class="hs-comment">--   and the text after the selection</span><span>
</span><span id="line-106"></span><span class="annot"><a href="Zipper.html#toText3"><span class="hs-identifier hs-type">toText3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span id="toText3"><span class="annot"><span class="annottext">toText3 :: Int -&gt; Int -&gt; Int -&gt; Zipper -&gt; (Text, Text, Text)
</span><a href="Zipper.html#toText3"><span class="hs-identifier hs-var hs-var">toText3</span></a></span></span><span> </span><span id="local-6989586621679070468"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070467"><span class="annot"><span class="annottext">h :: Int
</span><a href="#local-6989586621679070467"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679070466"><span class="annot"><span class="annottext">o :: Int
</span><a href="#local-6989586621679070466"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679070465"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070465"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070464"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070464"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070463"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070463"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070462"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070462"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070461"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070461"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070460"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070460"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070462"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070467"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-109"></span><span>   </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070467"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070462"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>   </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070457"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070455"><span class="hs-identifier hs-var">remL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070462"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070454"><span class="hs-identifier hs-var">remR</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070453"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070452"><span class="annot"><span class="annottext">sc :: Int
</span><a href="#local-6989586621679070452"><span class="hs-identifier hs-var">sc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070451"><span class="annot"><span class="annottext">ec :: Int
</span><a href="#local-6989586621679070451"><span class="hs-identifier hs-var">ec</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-var">cursorCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070465"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070449"><span class="annot"><span class="annottext">sr :: Int
</span><a href="#local-6989586621679070449"><span class="hs-identifier hs-var">sr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070448"><span class="annot"><span class="annottext">er :: Int
</span><a href="#local-6989586621679070448"><span class="hs-identifier hs-var">er</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorRow"><span class="hs-identifier hs-var">cursorRow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070465"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-114"></span><span>      </span><span id="local-6989586621679070455"><span class="annot"><span class="annottext">remL :: Text
</span><a href="#local-6989586621679070455"><span class="hs-identifier hs-var hs-var">remL</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.takeEnd</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070452"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070463"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621679070445"><span class="annot"><span class="annottext">slines :: Int
</span><a href="#local-6989586621679070445"><span class="hs-identifier hs-var hs-var">slines</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070448"><span class="hs-identifier hs-var">er</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070449"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-116"></span><span>      </span><span id="local-6989586621679070444"><span class="annot"><span class="annottext">fromTop :: Int
</span><a href="#local-6989586621679070444"><span class="hs-identifier hs-var hs-var">fromTop</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621679070457"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070457"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text
forall a (t :: * -&gt; *). (Monoid a, Foldable t) =&gt; t a -&gt; a
</span><a href="Lib.html#concatS"><span class="hs-identifier hs-var">concatS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; Seq Text
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070444"><span class="hs-identifier hs-var">fromTop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Zipper -&gt; Seq Text
</span><a href="Zipper.html#takeTop"><span class="hs-identifier hs-var">takeTop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070444"><span class="hs-identifier hs-var">fromTop</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070465"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>      </span><span id="local-6989586621679070454"><span class="annot"><span class="annottext">remR :: Text
</span><a href="#local-6989586621679070454"><span class="hs-identifier hs-var hs-var">remR</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070451"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070461"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-119"></span><span>      </span><span id="local-6989586621679070440"><span class="annot"><span class="annottext">fromBottom :: Int
</span><a href="#local-6989586621679070440"><span class="hs-identifier hs-var hs-var">fromBottom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070467"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070466"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070445"><span class="hs-identifier hs-var">slines</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span id="local-6989586621679070453"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070453"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text
forall a (t :: * -&gt; *). (Monoid a, Foldable t) =&gt; t a -&gt; a
</span><a href="Lib.html#concatS"><span class="hs-identifier hs-var">concatS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; Seq Text
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070440"><span class="hs-identifier hs-var">fromBottom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Zipper -&gt; Seq Text
</span><a href="Zipper.html#takeBottom"><span class="hs-identifier hs-var">takeBottom</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070468"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070440"><span class="hs-identifier hs-var">fromBottom</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070465"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Zipper.html#splitStart"><span class="hs-identifier hs-type">splitStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span id="splitStart"><span class="annot"><span class="annottext">splitStart :: Int -&gt; Zipper -&gt; (Text, Text)
</span><a href="Zipper.html#splitStart"><span class="hs-identifier hs-var hs-var">splitStart</span></a></span></span><span> </span><span id="local-6989586621679070437"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070437"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070436"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070436"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070435"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070435"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070434"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070434"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropEnd</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070432"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070434"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.takeEnd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070432"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070434"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>      </span><span id="local-6989586621679070432"><span class="annot"><span class="annottext">sc :: Int
</span><a href="#local-6989586621679070432"><span class="hs-identifier hs-var hs-var">sc</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Int) -&gt; Position -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-var">cursorCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070437"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070436"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Takes n lines of length w (or ending in a newline) from the text which precedes the first line</span><span>
</span><span id="line-128"></span><span class="hs-comment">--   of the current selection</span><span>
</span><span id="line-129"></span><span class="annot"><a href="Zipper.html#takeTop"><span class="hs-identifier hs-type">takeTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-130"></span><span id="takeTop"><span class="annot"><span class="annottext">takeTop :: Int -&gt; Int -&gt; Zipper -&gt; Seq Text
</span><a href="Zipper.html#takeTop"><span class="hs-identifier hs-var hs-var">takeTop</span></a></span></span><span> </span><span id="local-6989586621679070431"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070431"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070430"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070430"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679070429"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070429"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070428"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070428"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070427"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070427"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070430"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Seq Text -&gt; Seq Text
</span><a href="#local-6989586621679070425"><span class="hs-identifier hs-var">takeTop'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070431"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070424"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070428"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq Text -&gt; Seq Text
forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070423"><span class="hs-identifier hs-var">fromCurrentPar'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-comment">-- first grab lines before the first line of the selection but in the same paragraph</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070422"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070422"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; (Text, Text)
</span><a href="Zipper.html#splitStart"><span class="hs-identifier hs-var">splitStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070431"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070429"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621679070421"><span class="annot"><span class="annottext">fromCurrentPar :: Seq Text
</span><a href="#local-6989586621679070421"><span class="hs-identifier hs-var hs-var">fromCurrentPar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Seq Text
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Seq Text) -&gt; [Text] -&gt; Seq Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.chunksOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070431"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070422"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-135"></span><span>      </span><span id="local-6989586621679070419"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070419"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Int
forall a. Seq a -&gt; Int
</span><span class="hs-identifier hs-var">S.length</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070421"><span class="hs-identifier hs-var">fromCurrentPar</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span id="local-6989586621679070423"><span class="annot"><span class="annottext">fromCurrentPar' :: Seq Text
</span><a href="#local-6989586621679070423"><span class="hs-identifier hs-var hs-var">fromCurrentPar'</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; Seq Text
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070419"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070430"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070421"><span class="hs-identifier hs-var">fromCurrentPar</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span id="local-6989586621679070424"><span class="annot"><span class="annottext">n' :: Int
</span><a href="#local-6989586621679070424"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070430"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070419"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-comment">-- then take from the preceding paragraphs</span><span>
</span><span id="line-140"></span><span>      </span><span id="local-6989586621679070425"><span class="annot"><span class="annottext">takeTop' :: Int -&gt; Int -&gt; Seq Text -&gt; Seq Text
</span><a href="#local-6989586621679070425"><span class="hs-identifier hs-var hs-var">takeTop'</span></a></span></span><span> </span><span id="local-6989586621679070416"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070416"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><a href="#local-6989586621679070425"><span class="hs-identifier hs-var">takeTop'</span></a></span><span> </span><span id="local-6989586621679070415"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070415"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070414"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070414"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070413"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070413"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span> </span><span id="local-6989586621679070412"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070412"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070414"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>                        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070410"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070414"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-145"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070409"><span class="hs-identifier hs-var">fromEnd</span></a></span><span>
</span><span id="line-146"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Seq Text -&gt; Seq Text
</span><a href="#local-6989586621679070425"><span class="hs-identifier hs-var">takeTop'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070415"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070414"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070410"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070413"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq Text -&gt; Seq Text
forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070409"><span class="hs-identifier hs-var">fromEnd</span></a></span><span>
</span><span id="line-147"></span><span>                        </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>                           </span><span id="local-6989586621679070408"><span class="annot"><span class="annottext">lins :: Seq Text
</span><a href="#local-6989586621679070408"><span class="hs-identifier hs-var hs-var">lins</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Seq Text
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.chunksOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070415"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070412"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                           </span><span id="local-6989586621679070407"><span class="annot"><span class="annottext">lins' :: Seq Text
</span><a href="#local-6989586621679070407"><span class="hs-identifier hs-var hs-var">lins'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070408"><span class="hs-identifier hs-var">lins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>                                    </span><span id="local-6989586621679070406"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070406"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span> </span><span id="local-6989586621679070405"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070405"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070406"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Seq Text
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070405"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>                                    </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>                           </span><span id="local-6989586621679070410"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070410"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Int
forall a. Seq a -&gt; Int
</span><span class="hs-identifier hs-var">S.length</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070407"><span class="hs-identifier hs-var">lins'</span></a></span><span>
</span><span id="line-153"></span><span>                           </span><span id="local-6989586621679070409"><span class="annot"><span class="annottext">fromEnd :: Seq Text
</span><a href="#local-6989586621679070409"><span class="hs-identifier hs-var hs-var">fromEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq Text
forall a. Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.reverse</span></span><span> </span><span class="annot"><span class="annottext">(Seq Text -&gt; Seq Text) -&gt; Seq Text -&gt; Seq Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; Seq Text
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070414"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Text -&gt; Seq Text
forall a. Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.reverse</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070407"><span class="hs-identifier hs-var">lins'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Zipper.html#splitEnd"><span class="hs-identifier hs-type">splitEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span id="splitEnd"><span class="annot"><span class="annottext">splitEnd :: Int -&gt; Zipper -&gt; (Text, Text)
</span><a href="Zipper.html#splitEnd"><span class="hs-identifier hs-var hs-var">splitEnd</span></a></span></span><span> </span><span id="local-6989586621679070402"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070402"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070401"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070401"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070400"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070400"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679070399"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070399"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070402"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070398"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070399"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070402"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070398"><span class="hs-identifier hs-var">ec</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070399"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-158"></span><span>      </span><span id="local-6989586621679070398"><span class="annot"><span class="annottext">ec :: Int
</span><a href="#local-6989586621679070398"><span class="hs-identifier hs-var hs-var">ec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Int) -&gt; Position -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-var">cursorCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070402"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070401"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Takes n lines of length w (or ending in a newline) from the text which follows the last line of</span><span>
</span><span id="line-161"></span><span class="hs-comment">--   the current selection</span><span>
</span><span id="line-162"></span><span class="annot"><a href="Zipper.html#takeBottom"><span class="hs-identifier hs-type">takeBottom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-163"></span><span id="takeBottom"><span class="annot"><span class="annottext">takeBottom :: Int -&gt; Int -&gt; Zipper -&gt; Seq Text
</span><a href="Zipper.html#takeBottom"><span class="hs-identifier hs-var hs-var">takeBottom</span></a></span></span><span> </span><span id="local-6989586621679070396"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070396"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070395"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070395"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679070394"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070394"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679070393"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070393"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070392"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070392"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070395"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>
</span><span id="line-164"></span><span>                                      </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; Seq Text
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070395"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070391"><span class="hs-identifier hs-var">fromCurrentPar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Seq Text
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq Text -&gt; Seq Text
forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Seq Text -&gt; Seq Text
</span><a href="#local-6989586621679070390"><span class="hs-identifier hs-var">takeBottom'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070396"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070389"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070392"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-165"></span><span>                                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-comment">-- first grab lines after the final line of the selection but in the same paragraph</span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070388"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070388"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; (Text, Text)
</span><a href="Zipper.html#splitEnd"><span class="hs-identifier hs-var">splitEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070396"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070394"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span id="local-6989586621679070391"><span class="annot"><span class="annottext">fromCurrentPar :: Seq Text
</span><a href="#local-6989586621679070391"><span class="hs-identifier hs-var hs-var">fromCurrentPar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Seq Text
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Seq Text) -&gt; [Text] -&gt; Seq Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.chunksOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070396"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070388"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span id="local-6989586621679070389"><span class="annot"><span class="annottext">n' :: Int
</span><a href="#local-6989586621679070389"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070395"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Int
forall a. Seq a -&gt; Int
</span><span class="hs-identifier hs-var">S.length</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070391"><span class="hs-identifier hs-var">fromCurrentPar</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-comment">-- then take from the following paragraphs</span><span>
</span><span id="line-173"></span><span>      </span><span id="local-6989586621679070390"><span class="annot"><span class="annottext">takeBottom' :: Int -&gt; Int -&gt; Seq Text -&gt; Seq Text
</span><a href="#local-6989586621679070390"><span class="hs-identifier hs-var hs-var">takeBottom'</span></a></span></span><span> </span><span id="local-6989586621679070387"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070387"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070386"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070386"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><a href="#local-6989586621679070390"><span class="hs-identifier hs-var">takeBottom'</span></a></span><span> </span><span id="local-6989586621679070385"><span class="annot"><span class="annottext">w :: Int
</span><a href="#local-6989586621679070385"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679070384"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070384"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070383"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070383"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span> </span><span id="local-6989586621679070382"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070382"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070384"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>                        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070381"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070384"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-178"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070380"><span class="hs-identifier hs-var">fromStart</span></a></span><span>
</span><span id="line-179"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070380"><span class="hs-identifier hs-var">fromStart</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Seq Text -&gt; Seq Text
forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Seq Text -&gt; Seq Text
</span><a href="#local-6989586621679070390"><span class="hs-identifier hs-var">takeBottom'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070385"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070384"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070381"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070382"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-180"></span><span>                           </span><span class="hs-keyword">where</span><span>
</span><span id="line-181"></span><span>                              </span><span id="local-6989586621679070379"><span class="annot"><span class="annottext">lins :: Seq Text
</span><a href="#local-6989586621679070379"><span class="hs-identifier hs-var hs-var">lins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Seq Text
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; [Text]
</span><span class="hs-identifier hs-var">T.chunksOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070385"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070383"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                              </span><span id="local-6989586621679070378"><span class="annot"><span class="annottext">lins' :: Seq Text
</span><a href="#local-6989586621679070378"><span class="hs-identifier hs-var hs-var">lins'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070379"><span class="hs-identifier hs-var">lins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-183"></span><span>                                 </span><span id="local-6989586621679070377"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070377"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span> </span><span id="local-6989586621679070376"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070376"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070377"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Seq Text
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070376"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                                 </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>                              </span><span id="local-6989586621679070381"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070381"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Int
forall a. Seq a -&gt; Int
</span><span class="hs-identifier hs-var">S.length</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070378"><span class="hs-identifier hs-var">lins'</span></a></span><span>
</span><span id="line-186"></span><span>                              </span><span id="local-6989586621679070380"><span class="annot"><span class="annottext">fromStart :: Seq Text
</span><a href="#local-6989586621679070380"><span class="hs-identifier hs-var hs-var">fromStart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq Text -&gt; Seq Text
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070384"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070378"><span class="hs-identifier hs-var">lins'</span></a></span><span>
</span><span id="line-187"></span><span class="annot"><a href="Zipper.html#atBottom"><span class="hs-identifier hs-type">atBottom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-188"></span><span id="atBottom"><span class="annot"><span class="annottext">atBottom :: Zipper -&gt; Bool
</span><a href="Zipper.html#atBottom"><span class="hs-identifier hs-var hs-var">atBottom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Zipper.html#atBottom"><span class="hs-identifier hs-var">atBottom</span></a></span><span> </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Zipper.html#atTop"><span class="hs-identifier hs-type">atTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-192"></span><span id="atTop"><span class="annot"><span class="annottext">atTop :: Zipper -&gt; Bool
</span><a href="Zipper.html#atTop"><span class="hs-identifier hs-var hs-var">atTop</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Zipper.html#atTop"><span class="hs-identifier hs-var">atTop</span></a></span><span> </span><span class="hs-identifier">_</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Zipper.html#atEnd"><span class="hs-identifier hs-type">atEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-196"></span><span id="atEnd"><span class="annot"><span class="annottext">atEnd :: Zipper -&gt; Bool
</span><a href="Zipper.html#atEnd"><span class="hs-identifier hs-var hs-var">atEnd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Zipper.html#atEnd"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Moves the cursor up one row.</span><span>
</span><span id="line-200"></span><span class="hs-comment">--   Does nothing if the cursor is already at the topmost position.</span><span>
</span><span id="line-201"></span><span class="hs-comment">--</span><span>
</span><span id="line-202"></span><span class="hs-comment">--   &gt;&gt;&gt; upPar (makeZipper [&quot;0&quot;, &quot;1&quot;] &quot;1&quot; &quot;2&quot; &quot;3&quot; [&quot;b&quot;]) == makeZipper [&quot;0&quot;] &quot;&quot; &quot;1&quot; &quot;&quot; [&quot;123&quot;, &quot;b&quot;]</span><span>
</span><span id="line-203"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-204"></span><span class="hs-comment">--</span><span>
</span><span id="line-205"></span><span class="hs-comment">--   &gt;&gt;&gt; upPar (makeZipper [&quot;hi&quot;] &quot;1&quot; &quot;2&quot; &quot;3&quot; [&quot;b&quot;]) == makeZipper [] &quot;&quot; &quot;h&quot; &quot;i&quot; [&quot;123&quot;, &quot;b&quot;]</span><span>
</span><span id="line-206"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">--   &gt;&gt;&gt; upPar (makeZipper [&quot;hello&quot;] &quot;1&quot; &quot;2&quot; &quot;3&quot; []) == makeZipper [] &quot;&quot; &quot;h&quot; &quot;ello&quot; [&quot;123&quot;]</span><span>
</span><span id="line-209"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Zipper.html#upPar"><span class="hs-identifier hs-type">upPar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-211"></span><span id="upPar"><span class="annot"><span class="annottext">upPar :: Zipper -&gt; Zipper
</span><a href="Zipper.html#upPar"><span class="hs-identifier hs-var hs-var">upPar</span></a></span></span><span> </span><span id="local-6989586621679070371"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070371"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070370"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070370"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070369"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070369"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070368"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070368"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070367"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070367"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070366"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070366"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070370"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">Empty</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070371"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-213"></span><span>                                 </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070365"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070364"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070363"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070362"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-214"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070365"><span class="annot"><span class="annottext">a' :: Seq Text
</span><a href="#local-6989586621679070365"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070361"><span class="annot"><span class="annottext">newLine :: Text
</span><a href="#local-6989586621679070361"><span class="hs-identifier hs-var">newLine</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; (Seq Text, Text)
forall a. Seq a -&gt; (Seq a, a)
</span><a href="Lib.html#seqUnsnoc"><span class="hs-identifier hs-var">seqUnsnoc</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070370"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070364"><span class="annot"><span class="annottext">s' :: Text
</span><a href="#local-6989586621679070364"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070363"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070363"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070361"><span class="hs-identifier hs-var">newLine</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span id="local-6989586621679070359"><span class="annot"><span class="annottext">oldLine :: Text
</span><a href="#local-6989586621679070359"><span class="hs-identifier hs-var hs-var">oldLine</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070369"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070368"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070367"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>      </span><span id="local-6989586621679070362"><span class="annot"><span class="annottext">b' :: Seq Text
</span><a href="#local-6989586621679070362"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070359"><span class="hs-identifier hs-var">oldLine</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Seq Text -&gt; Seq Text
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070366"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Moves up n rows</span><span>
</span><span id="line-221"></span><span class="annot"><a href="Zipper.html#upPars"><span class="hs-identifier hs-type">upPars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-222"></span><span id="upPars"><span class="annot"><span class="annottext">upPars :: Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#upPars"><span class="hs-identifier hs-var hs-var">upPars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Int -&gt; Zipper -&gt; Zipper
forall n a. (Integral n, Eq a) =&gt; (a -&gt; a) -&gt; n -&gt; a -&gt; a
</span><a href="Lib.html#appFix"><span class="hs-identifier hs-var">appFix</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Zipper
</span><a href="Zipper.html#upPar"><span class="hs-identifier hs-var">upPar</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Moves the cursor down one row.</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   Does nothing if the cursor is already at the bottommost position.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">--   &gt;&gt;&gt; downPar (makeZipper [&quot;0&quot;] &quot;&quot; &quot;1&quot; &quot;2&quot; [&quot;b&quot;, &quot;c&quot;]) == makeZipper [&quot;0&quot;, &quot;12&quot;] &quot;&quot; &quot;b&quot; &quot;&quot; [&quot;c&quot;]</span><span>
</span><span id="line-228"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-comment">--   &gt;&gt;&gt; downPar (makeZipper [] &quot;&quot; &quot;!&quot; &quot;&quot; [&quot;single&quot;]) == makeZipper [&quot;!&quot;] &quot;&quot; &quot;s&quot; &quot;ingle&quot; []</span><span>
</span><span id="line-231"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-232"></span><span class="annot"><a href="Zipper.html#downPar"><span class="hs-identifier hs-type">downPar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-233"></span><span id="downPar"><span class="annot"><span class="annottext">downPar :: Zipper -&gt; Zipper
</span><a href="Zipper.html#downPar"><span class="hs-identifier hs-var hs-var">downPar</span></a></span></span><span> </span><span id="local-6989586621679070355"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070355"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070354"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070354"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070353"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070353"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070352"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070352"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070351"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070351"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070350"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070350"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070350"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-234"></span><span>                                 </span><span class="annot"><span class="hs-identifier hs-type">Empty</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070355"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-235"></span><span>                                 </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070349"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070348"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070347"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070346"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-236"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070345"><span class="annot"><span class="annottext">newLine :: Text
</span><a href="#local-6989586621679070345"><span class="hs-identifier hs-var">newLine</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070346"><span class="annot"><span class="annottext">b' :: Seq Text
</span><a href="#local-6989586621679070346"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; (Text, Seq Text)
forall a. Seq a -&gt; (a, Seq a)
</span><a href="Lib.html#seqUncons"><span class="hs-identifier hs-var">seqUncons</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070350"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070348"><span class="annot"><span class="annottext">s' :: Text
</span><a href="#local-6989586621679070348"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070347"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070347"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070345"><span class="hs-identifier hs-var">newLine</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span id="local-6989586621679070343"><span class="annot"><span class="annottext">oldLine :: Text
</span><a href="#local-6989586621679070343"><span class="hs-identifier hs-var hs-var">oldLine</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070353"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070352"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070351"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>      </span><span id="local-6989586621679070349"><span class="annot"><span class="annottext">a' :: Seq Text
</span><a href="#local-6989586621679070349"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070354"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Seq Text
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070343"><span class="hs-identifier hs-var">oldLine</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | Moves down n rows</span><span>
</span><span id="line-243"></span><span class="annot"><a href="Zipper.html#downPars"><span class="hs-identifier hs-type">downPars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-244"></span><span id="downPars"><span class="annot"><span class="annottext">downPars :: Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#downPars"><span class="hs-identifier hs-var hs-var">downPars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Int -&gt; Zipper -&gt; Zipper
forall n a. (Integral n, Eq a) =&gt; (a -&gt; a) -&gt; n -&gt; a -&gt; a
</span><a href="Lib.html#appFix"><span class="hs-identifier hs-var">appFix</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Zipper
</span><a href="Zipper.html#downPar"><span class="hs-identifier hs-var">downPar</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | Moves the cursor left one column or to the end of the previous paragraph if at the leftmost</span><span>
</span><span id="line-247"></span><span class="hs-comment">--   position</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="hs-comment">--   &gt;&gt;&gt; stepLeft numbers == paragraph &quot;123&quot; &quot;4&quot; &quot;56789&quot;</span><span>
</span><span id="line-250"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-251"></span><span class="hs-comment">--</span><span>
</span><span id="line-252"></span><span class="hs-comment">--   &gt;&gt;&gt; goLeft 20 numbers == paragraph &quot;&quot; &quot;1&quot; &quot;23456789&quot;</span><span>
</span><span id="line-253"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">--   &gt;&gt;&gt; toText (stepLeft numbers) == toText numbers</span><span>
</span><span id="line-256"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-257"></span><span class="annot"><a href="Zipper.html#stepLeft"><span class="hs-identifier hs-type">stepLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-258"></span><span id="stepLeft"><span class="annot"><span class="annottext">stepLeft :: Zipper -&gt; Zipper
</span><a href="Zipper.html#stepLeft"><span class="hs-identifier hs-var hs-var">stepLeft</span></a></span></span><span> </span><span id="local-6989586621679070340"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070340"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070339"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070339"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070338"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070338"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070337"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070337"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070336"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070336"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070335"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070335"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-259"></span><span>   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Text, Char)
</span><span class="hs-identifier hs-var">unsnoc</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070338"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070334"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070334"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679070333"><span class="annot"><span class="annottext">s' :: Char
</span><a href="#local-6989586621679070333"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070339"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070334"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
Item Text
</span><a href="#local-6989586621679070333"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070337"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070336"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070335"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070339"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>                        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070340"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-263"></span><span>                        </span><span id="local-6989586621679070332"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070332"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span id="local-6989586621679070331"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070331"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070332"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070331"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#combineLine"><span class="hs-identifier hs-var">combineLine</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070340"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Seq Text -&gt; Seq Text
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070335"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | Moves left n times</span><span>
</span><span id="line-266"></span><span class="annot"><a href="Zipper.html#goLeft"><span class="hs-identifier hs-type">goLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-267"></span><span id="goLeft"><span class="annot"><span class="annottext">goLeft :: Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goLeft"><span class="hs-identifier hs-var hs-var">goLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Int -&gt; Zipper -&gt; Zipper
forall n a. (Integral n, Eq a) =&gt; (a -&gt; a) -&gt; n -&gt; a -&gt; a
</span><a href="Lib.html#appFix"><span class="hs-identifier hs-var">appFix</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Zipper
</span><a href="Zipper.html#stepLeft"><span class="hs-identifier hs-var">stepLeft</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Moves the cursor right one column.</span><span>
</span><span id="line-270"></span><span class="hs-comment">--   Does nothing if the cursor is already at the rightmost position.</span><span>
</span><span id="line-271"></span><span class="hs-comment">--</span><span>
</span><span id="line-272"></span><span class="hs-comment">--   &gt;&gt;&gt; stepRight numbers == paragraph &quot;12345&quot; &quot;6&quot; &quot;789&quot;</span><span>
</span><span id="line-273"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-274"></span><span class="hs-comment">--</span><span>
</span><span id="line-275"></span><span class="hs-comment">--   &gt;&gt;&gt; goRight 20 numbers == paragraph &quot;123456789&quot; &quot;&quot; &quot;&quot;</span><span>
</span><span id="line-276"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">--   &gt;&gt;&gt; toText (stepRight numbers) == toText numbers</span><span>
</span><span id="line-279"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Zipper.html#stepRight"><span class="hs-identifier hs-type">stepRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-281"></span><span id="stepRight"><span class="annot"><span class="annottext">stepRight :: Zipper -&gt; Zipper
</span><a href="Zipper.html#stepRight"><span class="hs-identifier hs-var hs-var">stepRight</span></a></span></span><span> </span><span id="local-6989586621679070328"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070328"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070327"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070327"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070326"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070326"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070325"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070325"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070324"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070324"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070323"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070323"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe (Char, Text)
</span><span class="hs-identifier hs-var">uncons</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070324"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070325"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Zipper
</span><a href="Zipper.html#downPar"><span class="hs-identifier hs-var">downPar</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070328"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070327"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070326"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070325"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070323"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-283"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070321"><span class="annot"><span class="annottext">s' :: Char
</span><a href="#local-6989586621679070321"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070320"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070320"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070327"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070326"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070325"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
Item Text
</span><a href="#local-6989586621679070321"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070320"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070323"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Moves right n columns</span><span>
</span><span id="line-286"></span><span class="annot"><a href="Zipper.html#goRight"><span class="hs-identifier hs-type">goRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-287"></span><span id="goRight"><span class="annot"><span class="annottext">goRight :: Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goRight"><span class="hs-identifier hs-var hs-var">goRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Int -&gt; Zipper -&gt; Zipper
forall n a. (Integral n, Eq a) =&gt; (a -&gt; a) -&gt; n -&gt; a -&gt; a
</span><a href="Lib.html#appFix"><span class="hs-identifier hs-var">appFix</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Zipper
</span><a href="Zipper.html#stepRight"><span class="hs-identifier hs-var">stepRight</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | Performs a move on a zipper (row, column).</span><span>
</span><span id="line-290"></span><span class="hs-comment">--   Vertically relative, horizontally relative to the x position after the vertical move.</span><span>
</span><span id="line-291"></span><span class="annot"><a href="Zipper.html#go"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-292"></span><span id="go"><span class="annot"><span class="annottext">go :: Int -&gt; Position -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#go"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679070317"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679070317"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070316"><span class="annot"><span class="annottext">y :: Int
</span><a href="#local-6989586621679070316"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070315"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679070315"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679070314"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070314"><span class="hs-identifier hs-var">z</span></a></span></span><span>
</span><span id="line-293"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070316"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070317"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070315"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Zipper -&gt; Zipper
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goDown"><span class="hs-identifier hs-var">goDown</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070316"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070317"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070314"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-294"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070316"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#go"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070317"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070315"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Zipper -&gt; Zipper
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goUp"><span class="hs-identifier hs-var">goUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070316"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070317"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070314"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-295"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070315"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goRight"><span class="hs-identifier hs-var">goRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070315"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070314"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-296"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070315"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goLeft"><span class="hs-identifier hs-var">goLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070315"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070314"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-297"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070314"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | Moves down one visual line (e.g. n characters, the length of a line on the screen)</span><span>
</span><span id="line-300"></span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span class="hs-comment">--   &gt;&gt;&gt; stepDown 5 (paragraph &quot;&quot; &quot;l&quot; &quot;ine line&quot;) == paragraph &quot;line &quot; &quot;l&quot; &quot;ine&quot;</span><span>
</span><span id="line-302"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-303"></span><span class="hs-comment">--</span><span>
</span><span id="line-304"></span><span class="hs-comment">--   &gt;&gt;&gt; stepDown 20 (Zipper [] &quot;between para&quot; &quot;&quot; &quot;&quot; [&quot;&quot;]) == Zipper [&quot;between para&quot;] &quot;&quot; &quot;&quot; &quot;&quot; []</span><span>
</span><span id="line-305"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-306"></span><span class="hs-comment">--</span><span>
</span><span id="line-307"></span><span class="hs-comment">--   &gt;&gt;&gt; stepDown 20 (Zipper [] &quot;between para&quot; &quot;&quot; &quot;&quot; [&quot;!&quot;]) == Zipper [&quot;between para&quot;] &quot;!&quot; &quot;&quot; &quot;&quot; []</span><span>
</span><span id="line-308"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-309"></span><span class="hs-comment">--</span><span>
</span><span id="line-310"></span><span class="hs-comment">--   &gt;&gt;&gt; stepDown 20 (Zipper [] &quot;be&quot; &quot;t&quot; &quot;ween&quot; [&quot;!!!&quot;]) == Zipper [&quot;between&quot;] &quot;!!&quot; &quot;!&quot; &quot;&quot; []</span><span>
</span><span id="line-311"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-312"></span><span class="hs-comment">--</span><span>
</span><span id="line-313"></span><span class="hs-comment">--   &gt;&gt;&gt; stepDown 4 (Zipper [] &quot;lin&quot; &quot;e&quot; &quot;l&quot; [&quot;not here&quot;]) == Zipper [] &quot;linel&quot; &quot;&quot; &quot;&quot; [&quot;not here&quot;]</span><span>
</span><span id="line-314"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-315"></span><span class="annot"><a href="Zipper.html#stepDown"><span class="hs-identifier hs-type">stepDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-316"></span><span id="stepDown"><span class="annot"><span class="annottext">stepDown :: Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#stepDown"><span class="hs-identifier hs-var hs-var">stepDown</span></a></span></span><span> </span><span id="local-6989586621679070308"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070308"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070307"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070307"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070306"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070306"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070305"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070305"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070304"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070304"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070303"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070303"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070302"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070302"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679070301"><span class="hs-identifier hs-var">atBottom</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070300"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070299"><span class="hs-identifier hs-var">wrap</span></a></span><span>
</span><span id="line-317"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>      </span><span id="local-6989586621679070298"><span class="annot"><span class="annottext">llen :: Int
</span><a href="#local-6989586621679070298"><span class="hs-identifier hs-var hs-var">llen</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070308"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-319"></span><span>      </span><span id="local-6989586621679070297"><span class="annot"><span class="annottext">leftChars :: Int
</span><a href="#local-6989586621679070297"><span class="hs-identifier hs-var hs-var">leftChars</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070305"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span id="local-6989586621679070296"><span class="annot"><span class="annottext">col :: Int
</span><a href="#local-6989586621679070296"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070297"><span class="hs-identifier hs-var">leftChars</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070298"><span class="hs-identifier hs-var">llen</span></a></span><span>
</span><span id="line-321"></span><span>      </span><span id="local-6989586621679070301"><span class="annot"><span class="annottext">atBottom :: Bool
</span><a href="#local-6989586621679070301"><span class="hs-identifier hs-var hs-var">atBottom</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070296"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070304"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070303"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070298"><span class="hs-identifier hs-var">llen</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070294"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070294"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070293"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070293"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070297"><span class="hs-identifier hs-var">leftChars</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070298"><span class="hs-identifier hs-var">llen</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#combineLine"><span class="hs-identifier hs-var">combineLine</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070307"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>      </span><span id="local-6989586621679070299"><span class="annot"><span class="annottext">wrap :: Zipper
</span><a href="#local-6989586621679070299"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070307"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070294"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">selection :: Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070293"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">right :: Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070293"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-324"></span><span>      </span><span id="local-6989586621679070300"><span class="annot"><span class="annottext">drop :: Zipper
</span><a href="#local-6989586621679070300"><span class="hs-identifier hs-var hs-var">drop</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070302"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070307"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-326"></span><span>                     </span><span class="hs-string">&quot;&quot;</span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span id="local-6989586621679070292"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070292"><span class="hs-identifier hs-var">xs</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Zipper
</span><a href="Zipper.html#downPar"><span class="hs-identifier hs-var">downPar</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070307"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-327"></span><span>                     </span><span id="local-6989586621679070291"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070291"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span id="local-6989586621679070290"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070290"><span class="hs-identifier hs-var">xs</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070306"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Seq Text
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#combineLine"><span class="hs-identifier hs-var">combineLine</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070307"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070289"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070288"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070287"><span class="hs-identifier hs-var">r''</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070286"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070290"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-328"></span><span>                        </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679070285"><span class="annot"><span class="annottext">top :: Text
</span><a href="#local-6989586621679070285"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070286"><span class="annot"><span class="annottext">rest :: Text
</span><a href="#local-6989586621679070286"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070298"><span class="hs-identifier hs-var">llen</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070291"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-330"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679070289"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070289"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070284"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070284"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070296"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070285"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-331"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679070288"><span class="annot"><span class="annottext">s' :: Text
</span><a href="#local-6989586621679070288"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070287"><span class="annot"><span class="annottext">r'' :: Text
</span><a href="#local-6989586621679070287"><span class="hs-identifier hs-var">r''</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070284"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Zipper.html#goDown"><span class="hs-identifier hs-type">goDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-334"></span><span id="goDown"><span class="annot"><span class="annottext">goDown :: Int -&gt; Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goDown"><span class="hs-identifier hs-var hs-var">goDown</span></a></span></span><span> </span><span id="local-6989586621679070283"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070283"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679070282"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070282"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070281"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070281"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Int -&gt; Zipper -&gt; Zipper
forall n a. (Integral n, Eq a) =&gt; (a -&gt; a) -&gt; n -&gt; a -&gt; a
</span><a href="Lib.html#appFix"><span class="hs-identifier hs-var">appFix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#stepDown"><span class="hs-identifier hs-var">stepDown</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070282"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070283"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070281"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | Moves up one visual line (e.g. n characters, the length of a line on the screen)</span><span>
</span><span id="line-337"></span><span class="hs-comment">--</span><span>
</span><span id="line-338"></span><span class="hs-comment">--   &gt;&gt;&gt; stepUp 2 (Zipper [] &quot;abcde&quot; &quot;f&quot; &quot;&quot; []) == Zipper [] &quot;abc&quot; &quot;d&quot; &quot;ef&quot; []</span><span>
</span><span id="line-339"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-340"></span><span class="hs-comment">--</span><span>
</span><span id="line-341"></span><span class="hs-comment">--   &gt;&gt;&gt; stepUp 2 (Zipper [&quot;&quot;] &quot;&quot; &quot;a&quot; &quot;b&quot; []) == Zipper [] &quot;&quot; &quot;&quot; &quot;&quot; [&quot;ab&quot;]</span><span>
</span><span id="line-342"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-343"></span><span class="hs-comment">--</span><span>
</span><span id="line-344"></span><span class="hs-comment">--   &gt;&gt;&gt; stepUp 10 (Zipper [&quot;abcdef&quot;] &quot;&quot; &quot;g&quot; &quot;h&quot; []) == Zipper [] &quot;&quot; &quot;a&quot; &quot;bcdef&quot; [&quot;gh&quot;]</span><span>
</span><span id="line-345"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-346"></span><span class="hs-comment">--</span><span>
</span><span id="line-347"></span><span class="hs-comment">--   &gt;&gt;&gt; stepUp 10 (Zipper [&quot;ab&quot;] &quot;cdef&quot; &quot;g&quot; &quot;h&quot; []) == Zipper [] &quot;ab&quot; &quot;&quot; &quot;&quot; [&quot;cdefgh&quot;]</span><span>
</span><span id="line-348"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-349"></span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span class="annot"><a href="Zipper.html#stepUp"><span class="hs-identifier hs-type">stepUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-351"></span><span id="stepUp"><span class="annot"><span class="annottext">stepUp :: Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#stepUp"><span class="hs-identifier hs-var hs-var">stepUp</span></a></span></span><span> </span><span id="local-6989586621679070279"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070279"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070278"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070278"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070277"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070277"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070276"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070276"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070275"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070275"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070274"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070274"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070273"><span class="hs-identifier hs-var">charsLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070272"><span class="hs-identifier hs-var">llen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070271"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070271"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070270"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070270"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070273"><span class="hs-identifier hs-var">charsLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070272"><span class="hs-identifier hs-var">llen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070276"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-353"></span><span>                         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679070269"><span class="annot"><span class="annottext">r'' :: Text
</span><a href="#local-6989586621679070269"><span class="hs-identifier hs-var hs-var">r''</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070270"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070275"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070274"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-354"></span><span>                             </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070278"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070271"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">selection :: Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070270"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">right :: Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070269"><span class="hs-identifier hs-var">r''</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-355"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070277"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-356"></span><span>                  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070278"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-357"></span><span>                  </span><span id="local-6989586621679070268"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070268"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Zipper
</span><a href="Zipper.html#upPar"><span class="hs-identifier hs-var">upPar</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070278"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-358"></span><span>                  </span><span id="local-6989586621679070267"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070267"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span id="local-6989586621679070266"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070266"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070278"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">above :: Seq Text
</span><a href="Zipper.html#above"><span class="hs-identifier hs-var">above</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070267"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070265"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">selection :: Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070264"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">right :: Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070263"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">below :: Seq Text
</span><a href="Zipper.html#below"><span class="hs-identifier hs-var">below</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070262"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-359"></span><span>                     </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679070261"><span class="annot"><span class="annottext">above :: Text
</span><a href="#local-6989586621679070261"><span class="hs-identifier hs-var">above</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070260"><span class="annot"><span class="annottext">last :: Text
</span><a href="#local-6989586621679070260"><span class="hs-identifier hs-var">last</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679070259"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070259"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070266"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070259"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070259"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070272"><span class="hs-identifier hs-var">llen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070266"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-361"></span><span>                        </span><span id="local-6989586621679070258"><span class="annot"><span class="annottext">column :: Int
</span><a href="#local-6989586621679070258"><span class="hs-identifier hs-var hs-var">column</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070273"><span class="hs-identifier hs-var">charsLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070272"><span class="hs-identifier hs-var">llen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679070257"><span class="annot"><span class="annottext">lastl :: Text
</span><a href="#local-6989586621679070257"><span class="hs-identifier hs-var">lastl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070256"><span class="annot"><span class="annottext">lastr :: Text
</span><a href="#local-6989586621679070256"><span class="hs-identifier hs-var">lastr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070258"><span class="hs-identifier hs-var">column</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070260"><span class="hs-identifier hs-var">last</span></a></span><span>
</span><span id="line-363"></span><span>                        </span><span id="local-6989586621679070265"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070265"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070261"><span class="hs-identifier hs-var">above</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070257"><span class="hs-identifier hs-var">lastl</span></a></span><span>
</span><span id="line-364"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679070264"><span class="annot"><span class="annottext">s' :: Text
</span><a href="#local-6989586621679070264"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070263"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070263"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070256"><span class="hs-identifier hs-var">lastr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>                        </span><span id="local-6989586621679070262"><span class="annot"><span class="annottext">b' :: Seq Text
</span><a href="#local-6989586621679070262"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#combineLine"><span class="hs-identifier hs-var">combineLine</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070278"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Seq Text -&gt; Seq Text
forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Seq Text
</span><a href="Zipper.html#below"><span class="hs-identifier hs-var hs-var">below</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070278"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>      </span><span id="local-6989586621679070273"><span class="annot"><span class="annottext">charsLeft :: Int
</span><a href="#local-6989586621679070273"><span class="hs-identifier hs-var hs-var">charsLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070276"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>      </span><span id="local-6989586621679070272"><span class="annot"><span class="annottext">llen :: Int
</span><a href="#local-6989586621679070272"><span class="hs-identifier hs-var hs-var">llen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070279"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="annot"><a href="Zipper.html#goUp"><span class="hs-identifier hs-type">goUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-371"></span><span id="goUp"><span class="annot"><span class="annottext">goUp :: Int -&gt; Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#goUp"><span class="hs-identifier hs-var hs-var">goUp</span></a></span></span><span> </span><span id="local-6989586621679070255"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679070255"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679070254"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070254"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070253"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070253"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Zipper -&gt; Zipper) -&gt; Int -&gt; Zipper -&gt; Zipper
forall n a. (Integral n, Eq a) =&gt; (a -&gt; a) -&gt; n -&gt; a -&gt; a
</span><a href="Lib.html#appFix"><span class="hs-identifier hs-var">appFix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#stepUp"><span class="hs-identifier hs-var">stepUp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070254"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070255"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070253"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="Zipper.html#selectionPos"><span class="hs-identifier hs-type">selectionPos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span id="selectionPos"><span class="annot"><span class="annottext">selectionPos :: Int -&gt; Zipper -&gt; (Position, Position)
</span><a href="Zipper.html#selectionPos"><span class="hs-identifier hs-var hs-var">selectionPos</span></a></span></span><span> </span><span id="local-6989586621679070251"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070251"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070250"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070250"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679070249"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679070248"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679070249"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679070248"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>      </span><span id="local-6989586621679070249"><span class="annot"><span class="annottext">row :: Position
</span><a href="#local-6989586621679070249"><span class="hs-identifier hs-var hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorRow"><span class="hs-identifier hs-var">cursorRow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070251"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070250"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-377"></span><span>      </span><span id="local-6989586621679070248"><span class="annot"><span class="annottext">col :: Position
</span><a href="#local-6989586621679070248"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-var">cursorCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070251"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070250"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Returns a 0-indexed (row, column) cursor position based on lines of length n</span><span>
</span><span id="line-380"></span><span class="hs-comment">--</span><span>
</span><span id="line-381"></span><span class="hs-comment">--   &gt;&gt;&gt; cursorStart 10 emptyZipper == (0,0)</span><span>
</span><span id="line-382"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">--   &gt;&gt;&gt; cursorStart 10 $ makeZipper [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;] &quot;01234&quot; &quot;5&quot; &quot;6789&quot; [&quot;below&quot;]</span><span>
</span><span id="line-385"></span><span class="hs-comment">--   (4,5)</span><span>
</span><span id="line-386"></span><span class="hs-comment">--</span><span>
</span><span id="line-387"></span><span class="hs-comment">--   &gt;&gt;&gt; cursorStart 2 $ makeZipper [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;] &quot;01234&quot; &quot;56&quot; &quot;6789&quot; [&quot;below&quot;]</span><span>
</span><span id="line-388"></span><span class="hs-comment">--   (6,1)</span><span>
</span><span id="line-389"></span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span class="annot"><a href="Zipper.html#cursorStart"><span class="hs-identifier hs-type">cursorStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-391"></span><span id="cursorStart"><span class="annot"><span class="annottext">cursorStart :: Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorStart"><span class="hs-identifier hs-var hs-var">cursorStart</span></a></span></span><span> </span><span id="local-6989586621679070246"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070246"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070245"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070245"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Int) -&gt; (Position, Position) -&gt; Position
forall a b. (a -&gt; b) -&gt; (a, a) -&gt; (b, b)
</span><a href="Lib.html#both"><span class="hs-identifier hs-var">both</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorRow"><span class="hs-identifier hs-var">cursorRow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070246"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070245"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-var">cursorCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070246"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070245"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Returns a 0-indexed (row, column) cursor position based on lines of length n</span><span>
</span><span id="line-394"></span><span class="hs-comment">--</span><span>
</span><span id="line-395"></span><span class="hs-comment">--   &gt;&gt;&gt; cursorEnd 10 emptyZipper == (0,0)</span><span>
</span><span id="line-396"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-397"></span><span class="hs-comment">--</span><span>
</span><span id="line-398"></span><span class="hs-comment">--   &gt;&gt;&gt; cursorEnd 10 $ makeZipper [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;] &quot;01234&quot; &quot;5&quot; &quot;6789&quot; [&quot;below&quot;]</span><span>
</span><span id="line-399"></span><span class="hs-comment">--   (4,5)</span><span>
</span><span id="line-400"></span><span class="hs-comment">--</span><span>
</span><span id="line-401"></span><span class="hs-comment">--   &gt;&gt;&gt; cursorEnd 2 $ makeZipper [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;] &quot;01234&quot; &quot;56&quot; &quot;789&quot; [&quot;below&quot;]</span><span>
</span><span id="line-402"></span><span class="hs-comment">--   (7,0)</span><span>
</span><span id="line-403"></span><span class="hs-comment">--</span><span>
</span><span id="line-404"></span><span class="annot"><a href="Zipper.html#cursorEnd"><span class="hs-identifier hs-type">cursorEnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-405"></span><span id="cursorEnd"><span class="annot"><span class="annottext">cursorEnd :: Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorEnd"><span class="hs-identifier hs-var hs-var">cursorEnd</span></a></span></span><span> </span><span id="local-6989586621679070242"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070242"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070241"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070241"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Int) -&gt; (Position, Position) -&gt; Position
forall a b. (a -&gt; b) -&gt; (a, a) -&gt; (b, b)
</span><a href="Lib.html#both"><span class="hs-identifier hs-var">both</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorRow"><span class="hs-identifier hs-var">cursorRow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070242"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070241"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-var">cursorCol</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070242"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070241"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Zipper.html#lsAbove"><span class="hs-identifier hs-type">lsAbove</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-408"></span><span id="lsAbove"><span class="annot"><span class="annottext">lsAbove :: Int -&gt; Zipper -&gt; Int
</span><a href="Zipper.html#lsAbove"><span class="hs-identifier hs-var hs-var">lsAbove</span></a></span></span><span> </span><span id="local-6989586621679070239"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070239"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070238"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070238"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070237"><span class="hs-identifier hs-var">prevChars</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070239"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-409"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>      </span><span id="local-6989586621679070237"><span class="annot"><span class="annottext">prevChars :: Int
</span><a href="#local-6989586621679070237"><span class="hs-identifier hs-var hs-var">prevChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Int -&gt; Int) -&gt; Int -&gt; Seq Text -&gt; Int
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679070235"><span class="annot"><span class="annottext">p :: Text
</span><a href="#local-6989586621679070235"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679070234"><span class="annot"><span class="annottext">sum :: Int
</span><a href="#local-6989586621679070234"><span class="hs-identifier hs-var">sum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="Lib.html#roundUp"><span class="hs-identifier hs-var">roundUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070235"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070239"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070234"><span class="hs-identifier hs-var">sum</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070238"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- | Returns a 0-indexed (colStart, colEnd) cursor position based on lines of length n</span><span>
</span><span id="line-413"></span><span class="annot"><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-type">cursorCol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-414"></span><span id="cursorCol"><span class="annot"><span class="annottext">cursorCol :: Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorCol"><span class="hs-identifier hs-var hs-var">cursorCol</span></a></span></span><span> </span><span id="local-6989586621679070233"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070233"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070232"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070232"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070231"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070231"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070230"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070230"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070229"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070228"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>      </span><span id="local-6989586621679070227"><span class="annot"><span class="annottext">onLeft :: Int
</span><a href="#local-6989586621679070227"><span class="hs-identifier hs-var hs-var">onLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070231"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-417"></span><span>      </span><span id="local-6989586621679070229"><span class="annot"><span class="annottext">start :: Int
</span><a href="#local-6989586621679070229"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070227"><span class="hs-identifier hs-var">onLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070233"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span id="local-6989586621679070228"><span class="annot"><span class="annottext">end :: Int
</span><a href="#local-6989586621679070228"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070227"><span class="hs-identifier hs-var">onLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070230"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070233"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- | Returns a 0-indexed (rowStart, rowEnd) cursor position based on lines of length n</span><span>
</span><span id="line-421"></span><span class="annot"><a href="Zipper.html#cursorRow"><span class="hs-identifier hs-type">cursorRow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-422"></span><span id="cursorRow"><span class="annot"><span class="annottext">cursorRow :: Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorRow"><span class="hs-identifier hs-var hs-var">cursorRow</span></a></span></span><span> </span><span id="local-6989586621679070226"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679070226"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679070225"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070225"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070224"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070224"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070223"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070223"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070222"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070222"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070221"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070220"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-424"></span><span>      </span><span id="local-6989586621679070219"><span class="annot"><span class="annottext">linesAbove :: Int
</span><a href="#local-6989586621679070219"><span class="hs-identifier hs-var hs-var">linesAbove</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Int
</span><a href="Zipper.html#lsAbove"><span class="hs-identifier hs-var">lsAbove</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070226"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070225"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070218"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070218"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; (Text, Text)
</span><a href="Zipper.html#splitStart"><span class="hs-identifier hs-var">splitStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070226"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070225"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span id="local-6989586621679070221"><span class="annot"><span class="annottext">start :: Int
</span><a href="#local-6989586621679070221"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070219"><span class="hs-identifier hs-var">linesAbove</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070218"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070226"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>      </span><span id="local-6989586621679070220"><span class="annot"><span class="annottext">end :: Int
</span><a href="#local-6989586621679070220"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070219"><span class="hs-identifier hs-var">linesAbove</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070218"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070222"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070226"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-comment">-- | Creates a new line from the current selection</span><span>
</span><span id="line-430"></span><span class="hs-comment">--</span><span>
</span><span id="line-431"></span><span class="hs-comment">--   &gt;&gt;&gt; split (paragraph &quot;moves up&quot; &quot;d&quot; &quot;oesn't&quot;) == makeZipper [&quot;moves up&quot;] &quot;&quot; &quot;d&quot; &quot;oesn't&quot; []</span><span>
</span><span id="line-432"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-433"></span><span class="hs-comment">--</span><span>
</span><span id="line-434"></span><span class="hs-comment">--   &gt;&gt;&gt; split (paragraph &quot;&quot; &quot;stays&quot; &quot;put&quot;) == makeZipper [&quot;&quot;] &quot;&quot; &quot;stays&quot; &quot;put&quot; []</span><span>
</span><span id="line-435"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-436"></span><span class="annot"><a href="Zipper.html#split"><span class="hs-identifier hs-type">split</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-437"></span><span id="split"><span class="annot"><span class="annottext">split :: Zipper -&gt; Zipper
</span><a href="Zipper.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070216"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070216"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070215"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070215"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070214"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070214"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070213"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070213"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070212"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070212"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070216"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Seq Text
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070215"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070214"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070213"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070212"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">-- | Removes a character from `left`</span><span>
</span><span id="line-440"></span><span class="hs-comment">--</span><span>
</span><span id="line-441"></span><span class="hs-comment">--   &gt;&gt;&gt; backspace (paragraph &quot;abc&quot; &quot;def&quot; &quot;ghi&quot;) == paragraph &quot;ab&quot; &quot;def&quot; &quot;ghi&quot;</span><span>
</span><span id="line-442"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-443"></span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span class="hs-comment">--   &gt;&gt;&gt; backspace (Zipper [&quot;moves&quot;] &quot;&quot; &quot;u&quot; &quot;p&quot; []) == Zipper [] &quot;moves&quot; &quot;u&quot; &quot;p&quot; []</span><span>
</span><span id="line-445"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-446"></span><span class="annot"><a href="Zipper.html#backspace"><span class="hs-identifier hs-type">backspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-447"></span><span id="backspace"><span class="annot"><span class="annottext">backspace :: Zipper -&gt; Zipper
</span><a href="Zipper.html#backspace"><span class="hs-identifier hs-var hs-var">backspace</span></a></span></span><span> </span><span id="local-6989586621679070210"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070210"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070209"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070209"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span id="local-6989586621679070208"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070208"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070207"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070207"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070206"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070206"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070209"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>                                    </span><span id="local-6989586621679070205"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070205"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:|&gt;</span></span><span id="local-6989586621679070204"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070204"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070210"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">above :: Seq Text
</span><a href="Zipper.html#above"><span class="hs-identifier hs-var">above</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070205"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070204"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-449"></span><span>                                    </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070210"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-450"></span><span class="annot"><a href="Zipper.html#backspace"><span class="hs-identifier hs-var">backspace</span></a></span><span> </span><span id="local-6989586621679070203"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070203"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070203"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropEnd</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070203"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- | Deletes the current selection</span><span>
</span><span id="line-453"></span><span class="hs-comment">--</span><span>
</span><span id="line-454"></span><span class="hs-comment">--   &gt;&gt;&gt; delete emptyZipper == emptyZipper</span><span>
</span><span id="line-455"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-456"></span><span class="hs-comment">--</span><span>
</span><span id="line-457"></span><span class="hs-comment">--   delete (paragraph &quot;&quot; &quot;A&quot; &quot;&quot;) == emptyZipper</span><span>
</span><span id="line-458"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-459"></span><span class="hs-comment">--</span><span>
</span><span id="line-460"></span><span class="hs-comment">--   &gt;&gt;&gt; delete (paragraph &quot;abc&quot; &quot;d&quot; &quot;efg&quot;) == paragraph &quot;abc&quot; &quot;e&quot; &quot;fg&quot;</span><span>
</span><span id="line-461"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-462"></span><span class="hs-comment">--</span><span>
</span><span id="line-463"></span><span class="hs-comment">--   &gt;&gt;&gt; delete (paragraph &quot;abc&quot; &quot;de&quot; &quot;fg&quot;) == paragraph &quot;abc&quot; &quot;f&quot; &quot;g&quot;</span><span>
</span><span id="line-464"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-465"></span><span class="hs-comment">--</span><span>
</span><span id="line-466"></span><span class="hs-comment">--   &gt;&gt;&gt; delete (Zipper [] &quot;abc&quot; &quot;d&quot; &quot;&quot; [&quot;e&quot;]) == Zipper [] &quot;abc&quot; &quot;&quot; &quot;&quot; [&quot;e&quot;]</span><span>
</span><span id="line-467"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-468"></span><span class="hs-comment">--</span><span>
</span><span id="line-469"></span><span class="hs-comment">--   &gt;&gt;&gt; delete (Zipper [] &quot;text&quot; &quot;&quot; &quot;&quot; [&quot;moves up&quot;]) == Zipper [] &quot;text&quot; &quot;m&quot; &quot;oves up&quot; []</span><span>
</span><span id="line-470"></span><span class="hs-comment">--   True</span><span>
</span><span id="line-471"></span><span class="hs-comment">--</span><span>
</span><span id="line-472"></span><span class="annot"><a href="Zipper.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-473"></span><span id="delete"><span class="annot"><span class="annottext">delete :: Zipper -&gt; Zipper
</span><a href="Zipper.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span id="local-6989586621679070201"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070201"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679070200"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070200"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070199"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070199"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070198"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070198"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070200"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679070196"><span class="annot"><span class="annottext">s' :: Text
</span><a href="#local-6989586621679070196"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070195"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070195"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070199"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070201"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selection :: Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070196"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">right :: Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070195"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-475"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070198"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-476"></span><span>                          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070201"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-477"></span><span>                          </span><span id="local-6989586621679070194"><span class="annot"><span class="annottext">x :: Text
</span><a href="#local-6989586621679070194"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-operator hs-type">:&lt;|</span></span><span id="local-6989586621679070193"><span class="annot"><span class="annottext">xs :: Seq Text
</span><a href="#local-6989586621679070193"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070192"><span class="hs-identifier hs-var">z'</span></a></span><span>
</span><span id="line-478"></span><span>                             </span><span class="hs-keyword">where</span><span>
</span><span id="line-479"></span><span>                                </span><span class="hs-special">(</span><span id="local-6989586621679070191"><span class="annot"><span class="annottext">s' :: Text
</span><a href="#local-6989586621679070191"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070190"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070190"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.splitAt</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070194"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-480"></span><span>                                </span><span id="local-6989586621679070192"><span class="annot"><span class="annottext">z' :: Zipper
</span><a href="#local-6989586621679070192"><span class="hs-identifier hs-var hs-var">z'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070201"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selection :: Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070191"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">right :: Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070190"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">below :: Seq Text
</span><a href="Zipper.html#below"><span class="hs-identifier hs-var">below</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070193"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Appends a character to the left of the selection</span><span>
</span><span id="line-483"></span><span class="annot"><a href="Zipper.html#appendChar"><span class="hs-identifier hs-type">appendChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-484"></span><span id="appendChar"><span class="annot"><span class="annottext">appendChar :: Char -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#appendChar"><span class="hs-identifier hs-var hs-var">appendChar</span></a></span></span><span> </span><span id="local-6989586621679070188"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679070188"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679070187"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070187"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070187"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Char -&gt; Text
</span><span class="hs-identifier hs-var">snoc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070187"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679070188"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- | Appends text to the left of the selection</span><span>
</span><span id="line-487"></span><span class="annot"><a href="Zipper.html#appendText"><span class="hs-identifier hs-type">appendText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-488"></span><span id="appendText"><span class="annot"><span class="annottext">appendText :: Text -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#appendText"><span class="hs-identifier hs-var hs-var">appendText</span></a></span></span><span> </span><span id="local-6989586621679070185"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679070185"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679070184"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070184"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070184"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070184"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070185"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | Extends the cursor to include the sentence which encloses the current selection.</span><span>
</span><span id="line-491"></span><span class="hs-comment">--   Does not handle acronyms well.</span><span>
</span><span id="line-492"></span><span class="hs-comment">--</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- &gt;&gt;&gt; selectSentence zSentences == zSentences'</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-495"></span><span class="annot"><a href="Zipper.html#selectSentence"><span class="hs-identifier hs-type">selectSentence</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-496"></span><span id="selectSentence"><span class="annot"><span class="annottext">selectSentence :: Zipper -&gt; Zipper
</span><a href="Zipper.html#selectSentence"><span class="hs-identifier hs-var hs-var">selectSentence</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070182"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070182"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070181"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070181"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070180"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070180"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070179"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070179"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070178"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070178"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070182"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070177"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070176"><span class="hs-identifier hs-var">onLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070180"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070175"><span class="hs-identifier hs-var">onRight</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070174"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070178"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-497"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-498"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070177"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070177"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070176"><span class="annot"><span class="annottext">onLeft :: Text
</span><a href="#local-6989586621679070176"><span class="hs-identifier hs-var">onLeft</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.breakOnEnd</span></span><span> </span><span class="annot"><span class="hs-string">&quot;. &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070181"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-499"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679070172"><span class="annot"><span class="annottext">before :: Text
</span><a href="#local-6989586621679070172"><span class="hs-identifier hs-var">before</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070171"><span class="annot"><span class="annottext">start :: Text
</span><a href="#local-6989586621679070171"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.dropEnd</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070172"><span class="hs-identifier hs-var">before</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.takeEnd</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070172"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070171"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070175"><span class="annot"><span class="annottext">onRight :: Text
</span><a href="#local-6989586621679070175"><span class="hs-identifier hs-var">onRight</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070174"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070174"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.breakOn</span></span><span> </span><span class="annot"><span class="hs-string">&quot;. &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070179"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-501"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679070169"><span class="annot"><span class="annottext">end :: Text
</span><a href="#local-6989586621679070169"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070169"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679070168"><span class="annot"><span class="annottext">end :: Text
</span><a href="#local-6989586621679070168"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070167"><span class="annot"><span class="annottext">start :: Text
</span><a href="#local-6989586621679070167"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070168"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070167"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="annot"><a href="Zipper.html#selectParagraph"><span class="hs-identifier hs-type">selectParagraph</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-505"></span><span id="selectParagraph"><span class="annot"><span class="annottext">selectParagraph :: Zipper -&gt; Zipper
</span><a href="Zipper.html#selectParagraph"><span class="hs-identifier hs-var hs-var">selectParagraph</span></a></span></span><span> </span><span id="local-6989586621679070165"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070165"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070165"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">left :: Text
</span><a href="Zipper.html#left"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">selection :: Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#combineLine"><span class="hs-identifier hs-var">combineLine</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070165"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">right :: Text
</span><a href="Zipper.html#right"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-comment">-- | Applies a function to the selection</span><span>
</span><span id="line-508"></span><span class="annot"><a href="Zipper.html#toSelection"><span class="hs-identifier hs-type">toSelection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-509"></span><span id="toSelection"><span class="annot"><span class="annottext">toSelection :: (Text -&gt; Text) -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#toSelection"><span class="hs-identifier hs-var hs-var">toSelection</span></a></span></span><span> </span><span id="local-6989586621679070163"><span class="annot"><span class="annottext">f :: Text -&gt; Text
</span><a href="#local-6989586621679070163"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679070162"><span class="annot"><span class="annottext">z :: Zipper
</span><a href="#local-6989586621679070162"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070162"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selection :: Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621679070163"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Zipper -&gt; Text
</span><a href="Zipper.html#selection"><span class="hs-identifier hs-var hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070162"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="annot"><a href="Zipper.html#toUpper"><span class="hs-identifier hs-type">toUpper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-512"></span><span id="toUpper"><span class="annot"><span class="annottext">toUpper :: Zipper -&gt; Zipper
</span><a href="Zipper.html#toUpper"><span class="hs-identifier hs-var hs-var">toUpper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#toSelection"><span class="hs-identifier hs-var">toSelection</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Zipper.html#toLower"><span class="hs-identifier hs-type">toLower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-515"></span><span id="toLower"><span class="annot"><span class="annottext">toLower :: Zipper -&gt; Zipper
</span><a href="Zipper.html#toLower"><span class="hs-identifier hs-var hs-var">toLower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#toSelection"><span class="hs-identifier hs-var">toSelection</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span id="sentences"><span class="annot"><span class="annottext">sentences :: String -&gt; [(Text, Int)]
</span><a href="Zipper.html#sentences"><span class="hs-identifier hs-var hs-var">sentences</span></a></span></span><span> </span><span id="local-6989586621679070156"><span class="annot"><span class="annottext">t :: String
</span><a href="#local-6989586621679070156"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Break () -&gt; (Text, Int)) -&gt; [Break ()] -&gt; [(Text, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679070155"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070155"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070155"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070155"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; (Text, Int))
-&gt; (Break () -&gt; Text) -&gt; Break () -&gt; (Text, Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Break () -&gt; Text
forall a. Break a -&gt; Text
</span><span class="hs-identifier hs-var hs-var">brkBreak</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Breaker () -&gt; Text -&gt; [Break ()]
forall a. Breaker a -&gt; Text -&gt; [Break a]
</span><span class="hs-identifier hs-var">breaks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocaleName -&gt; Breaker ()
</span><span class="hs-identifier hs-var">breakSentence</span></span><span> </span><span class="annot"><span class="annottext">LocaleName
</span><span class="hs-identifier hs-var">Current</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679070156"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">-- | Selects the text which is enclosed by some string s</span><span>
</span><span id="line-520"></span><span class="annot"><a href="Zipper.html#selectEnclosed"><span class="hs-identifier hs-type">selectEnclosed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-521"></span><span id="selectEnclosed"><span class="annot"><span class="annottext">selectEnclosed :: Text -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#selectEnclosed"><span class="hs-identifier hs-var hs-var">selectEnclosed</span></a></span></span><span> </span><span id="local-6989586621679070150"><span class="annot"><span class="annottext">t :: Text
</span><a href="#local-6989586621679070150"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span id="local-6989586621679070149"><span class="annot"><span class="annottext">a :: Seq Text
</span><a href="#local-6989586621679070149"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070148"><span class="annot"><span class="annottext">l :: Text
</span><a href="#local-6989586621679070148"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070147"><span class="annot"><span class="annottext">s :: Text
</span><a href="#local-6989586621679070147"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679070146"><span class="annot"><span class="annottext">r :: Text
</span><a href="#local-6989586621679070146"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679070145"><span class="annot"><span class="annottext">b :: Seq Text
</span><a href="#local-6989586621679070145"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070149"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070144"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070143"><span class="hs-identifier hs-var">onLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070147"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="Lib.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070142"><span class="hs-identifier hs-var">onRight</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070141"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Text
</span><a href="#local-6989586621679070145"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-522"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070144"><span class="annot"><span class="annottext">l' :: Text
</span><a href="#local-6989586621679070144"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070143"><span class="annot"><span class="annottext">onLeft :: Text
</span><a href="#local-6989586621679070143"><span class="hs-identifier hs-var">onLeft</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.breakOnEnd</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070150"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070148"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679070142"><span class="annot"><span class="annottext">onRight :: Text
</span><a href="#local-6989586621679070142"><span class="hs-identifier hs-var">onRight</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679070141"><span class="annot"><span class="annottext">r' :: Text
</span><a href="#local-6989586621679070141"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">T.breakOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070150"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679070146"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="annot"><a href="Zipper.html#selectWord"><span class="hs-identifier hs-type">selectWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-527"></span><span id="selectWord"><span class="annot"><span class="annottext">selectWord :: Zipper -&gt; Zipper
</span><a href="Zipper.html#selectWord"><span class="hs-identifier hs-var hs-var">selectWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Zipper -&gt; Zipper
</span><a href="Zipper.html#selectEnclosed"><span class="hs-identifier hs-var">selectEnclosed</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="annot"><a href="Zipper.html#posDiff"><span class="hs-identifier hs-type">posDiff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span id="posDiff"><span class="annot"><span class="annottext">posDiff :: Int -&gt; Zipper -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#posDiff"><span class="hs-identifier hs-var hs-var">posDiff</span></a></span></span><span> </span><span id="local-6989586621679070138"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679070138"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679070137"><span class="annot"><span class="annottext">a :: Zipper
</span><a href="#local-6989586621679070137"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679070136"><span class="annot"><span class="annottext">b :: Zipper
</span><a href="#local-6989586621679070136"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a b. (Num a, Num b) =&gt; (a, b) -&gt; (a, b) -&gt; (a, b)
</span><a href="Lib.html#pairDiff"><span class="hs-identifier hs-var">pairDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorStart"><span class="hs-identifier hs-var">cursorStart</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070138"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070137"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Zipper -&gt; Position
</span><a href="Zipper.html#cursorEnd"><span class="hs-identifier hs-var">cursorEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679070138"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper
</span><a href="#local-6989586621679070136"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">-- example zipper for testing and debugging:</span><span>
</span><span id="line-533"></span><span class="annot"><a href="Zipper.html#numbers"><span class="hs-identifier hs-type">numbers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-534"></span><span id="numbers"><span class="annot"><span class="annottext">numbers :: Zipper
</span><a href="Zipper.html#numbers"><span class="hs-identifier hs-var hs-var">numbers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#paragraph"><span class="hs-identifier hs-var">paragraph</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;1234&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;5&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;6789&quot;</span></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span id="zSentences"><span class="annot"><span class="annottext">zSentences :: Zipper
</span><a href="Zipper.html#zSentences"><span class="hs-identifier hs-var hs-var">zSentences</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#paragraph"><span class="hs-identifier hs-var">paragraph</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;A sentence. An&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;o&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ther. Final.&quot;</span></span><span>
</span><span id="line-537"></span><span id="zSentences%27"><span class="annot"><span class="annottext">zSentences' :: Zipper
</span><a href="Zipper.html#zSentences%27"><span class="hs-identifier hs-var hs-var">zSentences'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text -&gt; Zipper
</span><a href="Zipper.html#paragraph"><span class="hs-identifier hs-var">paragraph</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;A sentence.&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; Another.&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; Final.&quot;</span></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- | A zipper which can be manipulated in ghci in case a reviewer has trouble building the project.</span><span>
</span><span id="line-540"></span><span class="annot"><a href="Zipper.html#exampleZipper"><span class="hs-identifier hs-type">exampleZipper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Zipper.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span>
</span><span id="line-541"></span><span id="exampleZipper"><span class="annot"><span class="annottext">exampleZipper :: Zipper
</span><a href="Zipper.html#exampleZipper"><span class="hs-identifier hs-var hs-var">exampleZipper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;This is a paragraph above.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;This is another one.&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span>                       </span><span class="annot"><span class="hs-string">&quot;This is text on the left.&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;This is text on the right.&quot;</span></span><span>
</span><span id="line-543"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;This is a paragraph below.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;This is more text&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span id="ez"><span class="annot"><span class="annottext">ez :: Zipper
</span><a href="Zipper.html#ez"><span class="hs-identifier hs-var hs-var">ez</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq Text -&gt; Text -&gt; Text -&gt; Text -&gt; Seq Text -&gt; Zipper
</span><a href="Zipper.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;abcde&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;abcde&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-string">&quot;abc1234&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;3&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;5&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;abcde&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-string">&quot;abcde&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-546"></span></pre></body></html>